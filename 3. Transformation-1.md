# PySpark DataFrame Transformations — Easy Explanation

---

## Overview

This document explains common **PySpark DataFrame Transformations** in very simple language using practical examples.

We will cover:

* `select`
* `alias`
* `filter` (multiple scenarios)
* `withColumnRenamed`
* `withColumn` (multiple scenarios)
* `regexp_replace`

These are the most commonly used transformations while working with real datasets.

---

# 1. Display Data

## Code

```python
df.display()
```

## Meaning (Easy Language)

* Shows the full DataFrame.
* Used to **view the data**.
* Mostly used in Databricks.

---

# 2. SELECT Transformation

## Code

```python
df.select(col('Item_Identifier'),col('Item_Weight'),col('Item_Fat_Content')).display()
```

## Meaning

* Selects only specific columns from the DataFrame.
* Instead of showing all columns, we show only the required ones.

## Simple Example

If table has 20 columns but we need only 3 → we use `select`.

---

# 3. ALIAS (Rename Column Temporarily)

## Code

```python
df.select(col('Item_Identifier').alias('Item_ID')).display()
```

## Meaning

* Renames a column **temporarily**.
* The original DataFrame column name does **not** change.

## Use Case

* For reporting
* For better readability

---

# 4. Display Again

## Code

```python
df.display()
```

## Meaning

* Used again to see original DataFrame.
* Confirms that alias did not change original column name.

---

# 5. FILTER Transformation

Used to **select rows based on condition**.

---

## Scenario 1

### Code

```python
df.filter(col('Item_Fat_Content')=='Regular').display()
```

### Meaning

* Shows only rows where `Item_Fat_Content = Regular`.
* Works like **WHERE clause** in SQL.

---

## Scenario 2

### Code

```python
df.filter((col('Item_Type') == 'Soft Drinks') & (col('Item_Weight')<10)).display()
```

### Meaning

* Two conditions applied:

  * Item Type is Soft Drinks
  * Item Weight is less than 10
* Both conditions must be true.

### Concept

* `&` means **AND**

---

## Scenario 3

### Code

```python
df.filter((col('Outlet_Size').isNull()) & (col('Outlet_Location_Type').isin('Tier 1','Tier 2'))).display()
```

### Meaning

* Select rows where:

  * Outlet Size is NULL
  * Location Type is Tier 1 or Tier 2

### Concepts Used

| Function   | Meaning                                 |
| ---------- | --------------------------------------- |
| `isNull()` | Checks missing values                   |
| `isin()`   | Checks multiple values (like IN in SQL) |

---

# 6. withColumnRenamed

## Code

```python
df.withColumnRenamed('Item_Weight','Item_Wt').display()
```

## Meaning

* Permanently renames the column.
* Unlike alias, this **changes the DataFrame structure**.

---

# 7. withColumn

Used to:

* Create new column
* Modify existing column

---

## Scenario 1 — Add New Column

### Code

```python
df = df.withColumn('flag',lit("new"))

df.display()
```

### Meaning

* Creates a new column called `flag`.
* Every row will contain value `new`.

### Function Used

| Function | Meaning                       |
| -------- | ----------------------------- |
| `lit()`  | Adds constant value to column |

---

## Create Calculated Column

### Code

```python
df.withColumn('multiply',col('Item_Weight')*col('Item_MRP')).display()
```

### Meaning

* Creates new column `multiply`.
* Value = Item_Weight × Item_MRP.

### Use Case

* Revenue
* Profit
* Score calculation

---

## Scenario 2 — Replace Values in Column

### Code

```python
df = df.withColumn('Item_Fat_Content',regexp_replace(col('Item_Fat_Content'),"Regular","Reg"))\
    .withColumn('Item_Fat_Content',regexp_replace(col('Item_Fat_Content'),"Low Fat","Lf"))

df.display()
```

### Meaning

* Replaces text inside column.
* `Regular` becomes `Reg`
* `Low Fat` becomes `Lf`

### Function Used

| Function           | Meaning                           |
| ------------------ | --------------------------------- |
| `regexp_replace()` | Replaces string pattern in column |

---

# Quick Summary Table

| Transformation      | Purpose                        |
| ------------------- | ------------------------------ |
| `select`            | Choose specific columns        |
| `alias`             | Temporary rename               |
| `filter`            | Select rows based on condition |
| `withColumnRenamed` | Permanent rename               |
| `withColumn`        | Add or modify column           |
| `lit`               | Add constant value             |
| `regexp_replace`    | Replace text in column         |

---

# Key Interview Points

* `select` works on columns.
* `filter` works on rows.
* `alias` is temporary.
* `withColumnRenamed` is permanent.
* `withColumn` can both create and update columns.
* `regexp_replace` is used for data cleaning.

---

# Real World Usage

These transformations are heavily used in:

* Data Cleaning
* Feature Engineering
* Data Preparation for Machine Learning
* ETL Pipelines
* Data Warehousing Projects

---

**End of Document**
